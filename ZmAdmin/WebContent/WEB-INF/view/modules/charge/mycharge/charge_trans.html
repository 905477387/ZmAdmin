<!-- 
 * Generated by Blade.
 * 2017-10-18 15:37:01
 -->
@layout("/common/_container.html"){

<script type="text/javascript">
    var grid_selector = "#grid-table";
    var pager_selector = "#grid-pager";
    var _filter = "{'CustNo_equal':'${shiro.getUser().deptId}'}";

    var export_source = "mycharge.transList";

    $(function(){
        initGrid();
        initMenuBtn("btns", "${code}");
    });

    function initGrid(){
        var grid_url = "${ctxPath}/${code}/transList";
        var _colnames = ["id",
            "创建时间",
            "流水号",
            "会员卡号",
            "印刷号",
            "车牌号",
            "当时余额",
            "充值金额",
            "客户代码",
            "客户名称",
            "持有人",
            "审核状态",
            "审核状态"];
        var _colmodel = [{name:"id", index:"id", width:100, hidden:true},
            {name:"CreateTime", index:"CreateTime", width:100},
            {name:"OrderNo", index:"OrderNo", width:100},
            {name:"CardNo", index:"CardNo", width:150},
            {name:"CardSerialNo", index:"CardSerialNo", width:100},
            {name:"CarNo", index:"CarNo", width:80},
            {name:"Balance", index:"Balance", width:50,align:"right"},
            {name:"ChargeBalance", index:"ChargeBalance", width:50,align:"right"},
            {name:"CustNo", index:"CustNo", width:100},
            {name:"CustName", index:"CustName", width:100},
            {name:"HolderName", index:"HolderName", width:60},
            {name:"Status", index:"Status", width:100, hidden:true},
            {name:"StatusName", index:"Status", width:100, align:"center", formatter:statusShow}];

        jQuery(grid_selector).jqGrid({
            url : grid_url,
            shrinkToFit : true,
            multiselect : false,
            colNames : _colnames,
            colModel : _colmodel,
            jsonReader : {id :"id"},
            pager : pager_selector,
            postData : {where: _filter, sort : "isdeleted", order : "asc, id desc"}
        });
    }


    function statusShow(cellvalue, options, rowObject) {
        var lx = rowObject.Status;
        var sclass = "";
        switch (lx) {
            case 1:
                sclass = "label label-info arrowed-right arrowed-in";
                break;
            case 2:
                sclass = "label label-warning arrowed arrowed-right";
                break;
            case 3:
                sclass = "label label-danger arrowed arrowed-right";
                break;
            case 5:
                sclass = "label arrowed arrowed-right";
                break;
            default:
                sclass = "label label-info arrowed arrowed-right";
                break;
        }
        var html = "<span class='" + sclass + "'>" + rowObject.StatusName + "</span>";
        return html;
    }

    function btnCallBack(btn){
        if (btn.id == "mycharge_view") {
            window.location.href = "${ctxPath}/mycharge/"
            return;
        }
        /*
        var ids = getGridXls().join(",");
        var rows = getGridXls().length;
        if (btn.id == "charge_view") {
            if (rows == 0) {
                layer_alert("请选择一条数据!", "warn");
                return;
            }
            if (rows > 1) {
                layer_alert("只能一条数据!", "warn");
                return;
            }
            window.top.addTabs({
                id: "top_charge_view",
                title: "充值记录查看",
                url: "${ctxPath}/${code}/charge?OrderNo=" + ids,
                icon: "fa fa-jpy",
                close: true
            });
            return;
        }*/
    }
</script>


<!-- 配置 grid -->
<div class="row">
    <div class="col-xs-12 tb-grid">
        <!-- 配置 查询 -->
        @ var _col=[
        @		{name:"年份", index:"year_skip_true", type:"selectDiy", source:"charge.year"},
        @		{name:"月份", index:"month_skip_true", type:"selectDiy", source:"charge.month"},
        @		{name:"会员卡号", index:"CardNo", type:"text"},
        @		{name:"车牌号", index:"CarNo", type:"text"},
        @		{name:"流水号", index:"OrderNo", type:"text"},
        @		{name:"持有人", index:"HolderName", type:"text"},
        @		{name:"当时余额", index:"Balance", type:"text"},
        @		{name:"充值金额", index:"ChargeBalance", type:"text"},
        @		{name:"充值状态", index:"Status", type:"select_905"},
        @		{name:"客户代码", index:"CustNo", type:"text"},
        @		{name:"客户名称", index:"CustName", type:"text"}
        @];
        @ include("/common/_function/_search_multi.html",{"col":_col}){}
        <!-- 按钮 -->
        <div class="welljq well-sm" id="btns"></div>
        <!-- grid -->
        <table id="grid-table"></table>
        <!-- 分页-->
        <div id="grid-pager"></div>
    </div>
</div>

<!-- 引入所需的js -->
@include("/common/_listscript.html", {isExport : true}) {}

@}	